<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="UTF-8" />
		<title>Conversational Data Collection</title>
		<link
			href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.0/dist/css/bootstrap.min.css"
			rel="stylesheet"
		/>
	</head>
	<body>
		<div class="container mt-5">
			<form id="conversationForm">
				<div class="mb-3">
					<label for="speaker" class="form-label">Speaker</label>
					<select class="form-select" id="speaker">
						<option value="system">System</option>
						<option value="user">User</option>
						<option value="assistant">Assistant</option>
					</select>
				</div>
				<div class="mb-3">
					<label for="text" class="form-label">Text</label>
					<input
						type="text"
						class="form-control"
						id="text"
						placeholder="Enter text"
					/>
				</div>
				<button type="button" class="btn btn-secondary" id="addToList">
					Add to List
				</button>
				<button type="button" class="btn btn-info mt-2" id="addSystemPrompt">
					Add System Prompt
				</button>
			</form>
			<ul id="turnList">
				<!-- Conversational turns will be appended here -->
			</ul>
			<button type="button" class="btn btn-success" id="submitToServer">
				Submit to Server
			</button>
		</div>
		<script>
			const turnList = [];

			function addToList() {
				const turnData = {
					speaker: document.getElementById("speaker").value,
					text: document.getElementById("text").value,
				};
				turnList.push(turnData);
				const listItem = document.createElement("li");
				listItem.textContent = `${turnData.speaker}: ${turnData.text}`;
				document.getElementById("turnList").appendChild(listItem);
			}

			function submitToServer() {
				fetch("/submit-training", {
					method: "POST",
					headers: {
						"Content-Type": "application/json",
					},
					body: JSON.stringify(turnList),
				})
					.then((response) => response.json())
					.then((data) => {
						console.log("Success:", data);
					})
					.catch((error) => {
						console.error("Error:", error);
					});
			}

			function addSystemPrompt() {
				const defaultPrompt =
					"You are Amber. Amber is a witty, funny, Jarvis like AI Assistant. Responses should be unique, but related";
				const turnData = {
					speaker: "system",
					text: defaultPrompt,
				};
				turnList.push(turnData);
				const listItem = document.createElement("li");
				listItem.textContent = `${turnData.speaker}: ${turnData.text}`;
				document.getElementById("turnList").appendChild(listItem);
			}

			// Add event listeners
			document
				.getElementById("addSystemPrompt")
				.addEventListener("click", addSystemPrompt);

			document.getElementById("addToList").addEventListener("click", addToList);
			document
				.getElementById("submitToServer")
				.addEventListener("click", submitToServer);
		</script>
	</body>
</html>
